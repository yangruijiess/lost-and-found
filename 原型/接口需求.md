## 一、已调用的fetch接口列表

1. **登录接口** (`/api/login`) - 在 <mcfile name="index.html" path="e:\lost_and_found\lost-and-found\原型\index.html"></mcfile> 中
2. **注册接口** (`/api/register`) - 在 <mcfile name="index.html" path="e:\lost_and_found\lost-and-found\原型\index.html"></mcfile> 中
3. **招领物品列表接口** (`/api/found-items`) - 在 <mcfile name="失物招领平台_招领页面.html" path="e:\lost_and_found\lost-and-found\原型\失物招领平台_招领页面.html"></mcfile> 中
4. **失物物品列表接口** (`/api/lost-items`) - 在 <mcfile name="失物招领平台_失物页面.html" path="e:\lost_and_found\lost-and-found\原型\失物招领平台_失物页面.html"></mcfile> 中
5. **收藏操作接口** (`/api/favorites`) - 在 <mcfile name="失物招领平台_招领页面.html" path="e:\lost_and_found\lost-and-found\原型\失物招领平台_招领页面.html"></mcfile> 和 <mcfile name="失物招领平台_失物页面.html" path="e:\lost_and_found\lost-and-found\原型\失物招领平台_失物页面.html"></mcfile> 中
6. **图片获取接口** (`/api/images/:itemId`) - 在 <mcfile name="失物招领平台_失物页面.html" path="e:\lost_and_found\lost-and-found\原型\失物招领平台_失物页面.html"></mcfile> 和 <mcfile name="失物招领平台_招领页面.html" path="e:\lost_and_found\lost-and-found\原型\失物招领平台_招领页面.html"></mcfile> 中用于获取物品图片

## 二、后端实现方案

### 1. 技术栈选择

建议使用以下技术栈实现后端服务：
- **Node.js** + **Express.js**：轻量高效的Web框架
- **MySQL/PostgreSQL**：关系型数据库，适合存储用户信息和物品数据
- **MongoDB**：如果需要灵活的数据结构，也可以考虑
- **JWT**：用于用户认证和授权
- **bcrypt**：用于密码加密

### 2. 数据库设计

需要创建以下核心表：

**users表**
```sql
CREATE TABLE users (
    id INT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) UNIQUE NOT NULL,
    student_id VARCHAR(20) UNIQUE,
    email VARCHAR(100) UNIQUE NOT NULL,
    phone VARCHAR(20) UNIQUE,
    password VARCHAR(100) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

**found_items表**
```sql
CREATE TABLE found_items (
    id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(100) NOT NULL,
    description TEXT,
    category VARCHAR(50),
    location VARCHAR(100),
    found_time DATETIME,
    image_url VARCHAR(255),
    publisher_id INT,
    status VARCHAR(20) DEFAULT 'found',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (publisher_id) REFERENCES users(id)
);
```

**lost_items表**
```sql
CREATE TABLE lost_items (
    id INT PRIMARY KEY AUTO_INCREMENT,
    title VARCHAR(100) NOT NULL,
    description TEXT,
    category VARCHAR(50),
    location VARCHAR(100),
    lost_time DATETIME,
    image_url VARCHAR(255),
    publisher_id INT,
    status VARCHAR(20) DEFAULT 'lost',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    FOREIGN KEY (publisher_id) REFERENCES users(id)
);
```

**favorites表**
```sql
CREATE TABLE favorites (
    id INT PRIMARY KEY AUTO_INCREMENT,
    user_id INT NOT NULL,
    item_id INT NOT NULL,
    item_type ENUM('lost', 'found') NOT NULL DEFAULT 'found',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    UNIQUE KEY unique_favorite (user_id, item_id, item_type),
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

### 3. 接口实现

#### 3.1 登录接口 (`/api/login`)

**请求**: POST
**参数**:
```json
{
  "username": "用户名/学号",
  "password": "密码",
  "rememberMe": true/false
}
```

**实现逻辑**:
1. 验证请求参数
2. 查询用户是否存在
3. 验证密码
4. 生成JWT令牌
5. 返回令牌和用户信息

#### 3.2 注册接口 (`/api/register`)

**请求**: POST
**参数**:
```json
{
  "username": "用户名",
  "studentId": "学号",
  "email": "邮箱",
  "phone": "手机号",
  "password": "密码"
}
```

**实现逻辑**:
1. 验证请求参数格式
2. 检查用户名/邮箱/手机号是否已存在
3. 对密码进行bcrypt加密
4. 创建新用户记录
5. 返回成功信息

#### 3.3 招领物品列表接口 (`/api/found-items`)

**请求**: GET
**查询参数**:
- page: 页码
- limit: 每页数量（固定为6）
- category: 类别筛选
- timeRange: 时间范围
- location: 地点
- search: 搜索关键词

**实现逻辑**:
1. 解析查询参数
2. 构建数据库查询条件
3. 执行分页查询
4. 获取图片URL（如果存储在服务器）
5. 返回物品列表和分页信息

#### 3.4 失物物品列表接口 (`/api/lost-items`)

**请求**: GET
**查询参数**:
- page: 页码
- limit: 每页数量（固定为6）
- category: 类别筛选
- timeRange: 时间范围
- location: 地点
- search: 搜索关键词

**实现逻辑**:
1. 解析查询参数
2. 构建数据库查询条件
3. 执行分页查询
4. 获取图片URL（如果存储在服务器）
5. 返回物品列表和分页信息

#### 3.5 收藏操作接口 (`/api/favorites`)

**请求**: POST
**参数**:
```json
{
  "itemId": "物品ID",
  "type": "lost/found",
  "action": "favorite/unfavorite"
}
```

**实现逻辑**:
1. 验证请求参数
2. 检查用户是否已登录（通过JWT验证）
3. 根据action执行不同操作：
   - favorite: 在favorites表中创建记录，包含item_id和item_type
   - unfavorite: 从favorites表中删除对应item_id和item_type的记录
4. 返回操作结果

#### 3.6 图片获取接口 (`/api/images/:itemId`)

**请求**: GET
**查询参数**:
- type: 物品类型 ('lost' 或 'found')

**实现逻辑**:
1. 验证请求参数
2. 根据itemId和type查询对应表中的image_url
3. 如果找到图片，返回图片文件或重定向到图片URL
4. 如果未找到图片，返回默认占位图
5. 在招领页面使用时type参数值为'found'，在失物页面使用时type参数值为'lost'

        